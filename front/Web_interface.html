<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏</title>
    <style>
        :root {
            --bg-color: #f9fafb;
            --text-color: #111827;
            --card-bg: white;
            --header-bg: linear-gradient(135deg, #10b981, #047857);
            --header-color: white;
            --border-color: #d1d5db;
            --input-bg: white;
            --input-border: #d1d5db;
            --input-focus-border: #10b981;
            --input-focus-shadow: rgba(16, 185, 129, 0.2);
            --radio-bg: white;
            --error-color: #ef4444;
            --btn-bg: #059669;
            --btn-hover: #047857;
            --btn-disabled: #d1d5db;
            --result-color: #10b981;
            --decryption-bg: #ecfdf5;
            --decryption-border: #a7f3d0;
            --toggle-bg: #ecfdf5;
            --footer-color: #374151;
            --footer-border: #e5e7eb;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --radius: 0.5rem;
        }

        .dark-mode {
            --bg-color: #1a1a2e;
            --text-color: #e6e6e6;
            --card-bg: #16213e;
            --header-bg: linear-gradient(135deg, #0f3460, #1a1a2e);
            --header-color: #e6e6e6;
            --border-color: #394867;
            --input-bg: #0f3460;
            --input-border: #394867;
            --input-focus-border: #4cc9f0;
            --input-focus-shadow: rgba(76, 201, 240, 0.2);
            --radio-bg: #0f3460;
            --error-color: #f05454;
            --btn-bg: #4cc9f0;
            --btn-hover: #3aa8d8;
            --btn-disabled: #394867;
            --result-color: #4cc9f0;
            --decryption-bg: #0f3460;
            --decryption-border: #394867;
            --toggle-bg: #0f3460;
            --footer-color: #b0b0b0;
            --footer-border: #394867;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.5;
            color: var(--text-color);
            background-color: var(--bg-color);
            padding: 1rem;
            transition: background-color 0.3s, color 0.3s;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .theme-switcher {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 100;
        }

        .theme-btn {
            background-color: var(--btn-bg);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            box-shadow: var(--shadow);
            transition: background-color 0.3s;
        }

        .theme-btn:hover {
            background-color: var(--btn-hover);
        }

        .theme-btn .icon {
            font-size: 1.2rem;
        }

        header {
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            background: var(--header-bg);
            color: var(--header-color);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            transition: background 0.3s, color 0.3s;
        }

        h1 {
            font-size: 2.25rem;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
        }

        .form-section {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
            transition: background-color 0.3s;
        }

        h2 {
            font-size: 1.5rem;
            color: var(--result-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
            transition: color 0.3s, border-color 0.3s;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
        }

        .form-group {
            margin-bottom: 0;
        }

        label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: var(--text-color);
            transition: color 0.3s;
        }

        .required::after {
            content: " *";
            color: var(--error-color);
        }

        input, select, .radio-group {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--input-border);
            border-radius: var(--radius);
            font-size: 1rem;
            transition: border-color 0.2s, box-shadow 0.2s, background-color 0.3s, color 0.3s;
            background-color: var(--input-bg);
            color: var(--text-color);
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--input-focus-border);
            box-shadow: 0 0 0 3px var(--input-focus-shadow);
        }

        .radio-group {
            display: flex;
            gap: 1rem;
            padding: 0.75rem;
            background-color: var(--radio-bg);
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .radio-option input {
            width: auto;
        }

        .error {
            color: var(--error-color);
            font-size: 0.875rem;
            margin-top: 0.25rem;
            display: none;
            transition: color 0.3s;
        }

        .has-error input, .has-error select, .has-error .radio-group {
            border-color: var(--error-color);
        }

        .has-error .error {
            display: block;
        }

        .btn-container {
            margin-top: 2rem;
            text-align: center;
        }

        .btn {
            background-color: var(--btn-bg);
            color: white;
            border: none;
            padding: 1rem 2rem;
            font-size: 1.125rem;
            font-weight: 600;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            width: 100%;
            max-width: 300px;
        }

        .btn:hover {
            background-color: var(--btn-hover);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn:disabled {
            background-color: var(--btn-disabled);
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            position: relative;
            color: transparent;
        }

        .loading::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 1.25rem;
            height: 1.25rem;
            border: 2px solid white;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.8s linear infinite;
            transform: translate(-50%, -50%);
        }

        @keyframes spin {
            to {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        .code-decryption {
            margin-top: 1rem;
        }

        .decryption-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--toggle-bg);
            border: 1px solid var(--decryption-border);
            padding: 0.75rem 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .decryption-toggle:hover {
            opacity: 0.9;
        }

        .decryption-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
            border: 1px solid var(--decryption-border);
            border-top: none;
            border-radius: 0 0 var(--radius) var(--radius);
        }

        .decryption-content.active {
            max-height: 300px;
            overflow-y: auto;
        }

        .decryption-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 0.75rem;
            padding: 1rem;
        }

        .code-item {
            padding: 0.5rem;
            background-color: var(--card-bg);
            border-radius: 0.25rem;
            border-left: 3px solid var(--result-color);
            transition: background-color 0.3s;
        }

        .code-value {
            font-weight: 600;
            color: var(--result-color);
            transition: color 0.3s;
        }

        .code-desc {
            font-size: 0.875rem;
            color: var(--text-color);
            transition: color 0.3s;
        }

        .result-section {
            background-color: var(--card-bg);
            border-radius: var(--radius);
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-top: 2rem;
            display: none;
            transition: background-color 0.3s;
        }

        .result-section.show {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-container {
            text-align: center;
            padding: 1rem;
        }

        .probability-value {
            font-size: 4rem;
            font-weight: 700;
            color: var(--result-color);
            margin: 1rem 0;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.5s, transform 0.5s, color 0.3s;
        }

        .probability-value.show {
            opacity: 1;
            transform: scale(1);
        }

        .probability-description {
            font-size: 1.25rem;
            margin-bottom: 1rem;
            color: var(--text-color);
            padding: 0 1rem;
            transition: color 0.3s;
        }

        .footer {
            text-align: center;
            margin-top: 3rem;
            padding: 1.5rem;
            color: var(--footer-color);
            font-size: 0.875rem;
            border-top: 1px solid var(--footer-border);
            transition: color 0.3s, border-color 0.3s;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.75rem;
            }
            
            .form-section {
                padding: 1.5rem;
            }
            
            .probability-value {
                font-size: 3rem;
            }
            
            .btn {
                max-width: 100%;
            }
            
            .theme-switcher {
                position: static;
                margin-bottom: 1rem;
                text-align: center;
            }
            
            .theme-btn {
                display: inline-flex;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="theme-switcher">
            <button class="theme-btn" id="themeToggle">
                <span class="icon">üåô</span>
                <span>–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º</span>
            </button>
        </div>

        <header>
            <h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏</h1>
            <p class="subtitle">–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏</p>
        </header>

        <main>
            <section class="form-section">
                <h2>–î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞</h2>
                <form id="insuranceForm">
                    <div class="form-grid">
                        <!-- –í–æ–∑—Ä–∞—Å—Ç -->
                        <div class="form-group">
                            <label for="age" class="required">–í–æ–∑—Ä–∞—Å—Ç (–ª–µ—Ç)</label>
                            <input type="number" id="age" name="age" min="0" max="85" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç 0 –¥–æ 85" required>
                            <div class="error" id="ageError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç –æ—Ç 0 –¥–æ 85 –ª–µ—Ç</div>
                        </div>

                        <!-- –ü–æ–ª -->
                        <div class="form-group">
                            <label class="required">–ü–æ–ª</label>
                            <div class="radio-group" id="genderGroup">
                                <div class="radio-option">
                                    <input type="radio" id="male" name="gender" value="–ú—É–∂—á–∏–Ω–∞" required>
                                    <label for="male">–ú—É–∂—á–∏–Ω–∞</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="female" name="gender" value="–ñ–µ–Ω—â–∏–Ω–∞">
                                    <label for="female">–ñ–µ–Ω—â–∏–Ω–∞</label>
                                </div>
                            </div>
                            <div class="error" id="genderError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</div>
                        </div>

                        <!-- –ù–∞–ª–∏—á–∏–µ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤ -->
                        <div class="form-group">
                            <label class="required">–ù–∞–ª–∏—á–∏–µ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤</label>
                            <div class="radio-group" id="drivingLicenseGroup">
                                <div class="radio-option">
                                    <input type="radio" id="licenseYes" name="drivingLicense" value="1" required>
                                    <label for="licenseYes">–î–∞</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="licenseNo" name="drivingLicense" value="0">
                                    <label for="licenseNo">–ù–µ—Ç</label>
                                </div>
                            </div>
                            <div class="error" id="drivingLicenseError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –Ω–∞–ª–∏—á–∏–µ –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤</div>
                        </div>

                        <!-- –ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞ -->
                        <div class="form-group">
                            <label for="regionCode" class="required">–ö–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞</label>
                            <input type="number" id="regionCode" name="regionCode" min="0" max="52" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ —Ä–µ–≥–∏–æ–Ω–∞ –æ—Ç 0 –¥–æ 52" required>
                            <div class="error" id="regionCodeError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ</div>
                        </div>

                        <!-- –°—Ç—Ä–∞—Ö–æ–≤–∫–∞ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ -->
                        <div class="form-group">
                            <label class="required">–°—Ç—Ä–∞—Ö–æ–≤–∫–∞ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ</label>
                            <div class="radio-group" id="previouslyInsuredGroup">
                                <div class="radio-option">
                                    <input type="radio" id="insuredYes" name="previouslyInsured" value="1" required>
                                    <label for="insuredYes">–î–∞</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="insuredNo" name="previouslyInsured" value="0">
                                    <label for="insuredNo">–ù–µ—Ç</label>
                                </div>
                            </div>
                            <div class="error" id="previouslyInsuredError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω–æ–µ —Å—Ä–µ–¥—Å—Ç–≤–æ</div>
                        </div>

                        <!-- –í–æ–∑—Ä–∞—Å—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ -->
                        <div class="form-group">
                            <label for="vehicleAge" class="required">–í–æ–∑—Ä–∞—Å—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ (–ª–µ—Ç)</label>
                            <input type="number" id="vehicleAge" name="vehicleAge" min="0" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–∑—Ä–∞—Å—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞" required>
                            <div class="error" id="vehicleAgeError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ</div>
                        </div>

                        <!-- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è -->
                        <div class="form-group">
                            <label class="required">–ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è</label>
                            <div class="radio-group" id="vehicleDamageGroup">
                                <div class="radio-option">
                                    <input type="radio" id="damageYes" name="vehicleDamage" value="1" required>
                                    <label for="damageYes">–î–∞</label>
                                </div>
                                <div class="radio-option">
                                    <input type="radio" id="damageNo" name="vehicleDamage" value="0">
                                    <label for="damageNo">–ù–µ—Ç</label>
                                </div>
                            </div>
                            <div class="error" id="vehicleDamageError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ —Ñ–∞–∫—Ç –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è</div>
                        </div>

                        <!-- –°—Ç—Ä–∞—Ö–æ–≤–æ–π –≤–∑–Ω–æ—Å -->
                        <div class="form-group">
                            <label for="annualPremium" class="required">–°—Ç—Ä–∞—Ö–æ–≤–æ–π –≤–∑–Ω–æ—Å</label>
                            <input type="text" id="annualPremium" name="annualPremium" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—Ç—Ä–∞—Ö–æ–≤–æ–π –≤–∑–Ω–æ—Å" required>
                            <div class="error" id="annualPremiumError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —á–∏—Å–ª–æ</div>
                        </div>

                        <!-- –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫–ª–∏–µ–Ω—Ç–æ–º -->
                        <div class="form-group">
                            <label for="policySalesChannel" class="required">–ö–æ–¥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∏–µ–Ω—Ç–æ–º</label>
                            <input type="number" id="policySalesChannel" name="policySalesChannel" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –æ—Ç 1 –¥–æ 163" required>
                            <div class="error" id="policySalesChannelError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –¥–æ–ø—É—Å—Ç–∏–º—ã–π –∫–æ–¥ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</div>
                            
                            <!-- –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–¥–æ–≤ -->
                            <div class="code-decryption">
                                <div class="decryption-toggle" id="decryptionToggle">
                                    <span>–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞ –∫–æ–¥–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è</span>
                                    <span id="toggleIcon">‚ñº</span>
                                </div>
                                <div class="decryption-content" id="decryptionContent">
                                    <div class="decryption-grid" id="decryptionGrid">
                                        <!-- –ö–æ–¥—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π -->
                        <div class="form-group">
                            <label for="vintage" class="required">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π</label>
                            <input type="number" id="vintage" name="vintage" min="0" placeholder="–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π" required>
                            <div class="error" id="vintageError">–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ</div>
                        </div>
                    </div>

                    <div class="btn-container">
                        <button type="submit" class="btn" id="calculateBtn">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å</button>
                    </div>
                </form>
            </section>

            <section class="result-section" id="resultSection">
                <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å—á–µ—Ç–∞</h2>
                <div class="result-container">
                    <p>–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–æ–∫–∏ –≤ –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏:</p>
                    <div class="probability-value" id="probabilityValue">0%</div>
                    <p class="probability-description" id="probabilityDescription">
                        –í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏ –Ω–∞–∂–º–∏—Ç–µ "–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å"
                    </p>
                </div>
            </section>
        </main>

        <footer class="footer">
            <p>¬© 2025 –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã).</p>
            <p>–ü–æ–¥–≥–æ—Ç–æ–≤–∏–ª–∞ –∫–æ–º–∞–Ω–¥–∞ 4, —Ö–∏-—Ö–∏–∫.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –∫–æ–¥–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
            const EXCLUDED_CODES = [72, 77, 84, 85, 141, 142, 143, 144, 149, 161, 162];
            const HISTORICAL_FIGURES = [
                "–Æ–ª–∏–π –¶–µ–∑–∞—Ä—å", "–ö–ª–µ–æ–ø–∞—Ç—Ä–∞ VII", "–ù–∞–ø–æ–ª–µ–æ–Ω –ë–æ–Ω–∞–ø–∞—Ä—Ç", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–∞ –í–µ–ª–∏–∫–∞—è", 
                "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ú–∞–∫–µ–¥–æ–Ω—Å–∫–∏–π", "–ñ–∞–Ω–Ω–∞ –¥'–ê—Ä–∫", "–õ–µ–æ–Ω–∞—Ä–¥–æ –¥–∞ –í–∏–Ω—á–∏", "–£–∏–Ω—Å—Ç–æ–Ω –ß–µ—Ä—á–∏–ª–ª—å", 
                "–ê–ª—å–±–µ—Ä—Ç –≠–π–Ω—à—Ç–µ–π–Ω", "–ö–æ—Ä–æ–ª–µ–≤–∞ –í–∏–∫—Ç–æ—Ä–∏—è", "–ß–∏–Ω–≥–∏—Å—Ö–∞–Ω", "–ú–∞—Ä–∏—è –ö—é—Ä–∏", 
                "–ü–µ—Ç—Ä I", "–ê–≤—Ä–∞–∞–º –õ–∏–Ω–∫–æ–ª—å–Ω", "–ú–∞—Ä–∫ –¢–≤–µ–Ω", "–§—Ä–∏–¥–∞ –ö–∞–ª–æ", "–ò—Å–∞–∞–∫ –ù—å—é—Ç–æ–Ω", 
                "–ò–Ω–¥–∏—Ä–∞ –ì–∞–Ω–¥–∏", "–ú–∏–∫–µ–ª–∞–Ω–¥–∂–µ–ª–æ", "–ö–æ–∫–æ –®–∞–Ω–µ–ª—å", "–ê—Ä–∏—Å—Ç–æ—Ç–µ–ª—å", "–ê–º–µ–ª–∏—è –≠—Ä—Ö–∞—Ä—Ç", 
                "–°—Ç–∏–≤ –î–∂–æ–±—Å", "–ú–∞—Ä–≥–∞—Ä–µ—Ç –¢—ç—Ç—á–µ—Ä", "–ß–∞—Ä–ª–∏ –ß–∞–ø–ª–∏–Ω", "–ì–∞–ª–∏–ª–µ–æ –ì–∞–ª–∏–ª–µ–π", 
                "–ú–∞—Ä—Ç–∏–Ω –õ—é—Ç–µ—Ä –ö–∏–Ω–≥", "–ù–µ–ª—å—Å–æ–Ω –ú–∞–Ω–¥–µ–ª–∞", "–î–∂–æ—Ä–¥–∂ –í–∞—à–∏–Ω–≥—Ç–æ–Ω", "–¢–µ–æ–¥–æ—Ä –†—É–∑–≤–µ–ª—å—Ç", 
                "–ú—ç—Ä–∏–ª–∏–Ω –ú–æ–Ω—Ä–æ", "–≠—Ä–Ω–µ—Å—Ç–æ –ß–µ –ì–µ–≤–∞—Ä–∞", "–ú–∞—Ö–∞—Ç–º–∞ –ì–∞–Ω–¥–∏", "–≠–ª–µ–æ–Ω–æ—Ä–∞ –†—É–∑–≤–µ–ª—å—Ç", 
                "–°–æ–∫—Ä–∞—Ç", "–ù–∏–∫–∫–æ–ª–æ –ú–∞–∫–∏–∞–≤–µ–ª–ª–∏", "–í–æ–ª—å—Ñ–≥–∞–Ω–≥ –ê–º–∞–¥–µ–π –ú–æ—Ü–∞—Ä—Ç", "–õ—é–¥–≤–∏–≥ –≤–∞–Ω –ë–µ—Ç—Ö–æ–≤–µ–Ω"
            ];
            const INTERACTION_TYPES = {
                "–õ": "–ª–∏—á–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞",
                "–¢": "—Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä", 
                "–ü": "—ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞",
                "–ß": "—á–∞—Ç –≤ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–µ"
            };

            // –≠–ª–µ–º–µ–Ω—Ç—ã DOM
            const form = document.getElementById('insuranceForm');
            const calculateBtn = document.getElementById('calculateBtn');
            const probabilityValue = document.getElementById('probabilityValue');
            const probabilityDescription = document.getElementById('probabilityDescription');
            const policySalesChannelInput = document.getElementById('policySalesChannel');
            const decryptionToggle = document.getElementById('decryptionToggle');
            const decryptionContent = document.getElementById('decryptionContent');
            const decryptionGrid = document.getElementById('decryptionGrid');
            const toggleIcon = document.getElementById('toggleIcon');
            const resultSection = document.getElementById('resultSection');
            const themeToggle = document.getElementById('themeToggle');
            const themeIcon = themeToggle.querySelector('.icon');

            // –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–µ–º—ã
            let isDarkMode = false;

            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–º—ã
            function toggleTheme() {
                isDarkMode = !isDarkMode;
                document.body.classList.toggle('dark-mode', isDarkMode);
                
                if (isDarkMode) {
                    themeIcon.textContent = '‚òÄÔ∏è';
                    themeToggle.querySelector('span:last-child').textContent = '–î–Ω–µ–≤–Ω–æ–π —Ä–µ–∂–∏–º';
                    localStorage.setItem('theme', 'dark');
                } else {
                    themeIcon.textContent = 'üåô';
                    themeToggle.querySelector('span:last-child').textContent = '–ù–æ—á–Ω–æ–π —Ä–µ–∂–∏–º';
                    localStorage.setItem('theme', 'light');
                }
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –∏–∑ localStorage
            function initTheme() {
                const savedTheme = localStorage.getItem('theme');
                if (savedTheme === 'dark') {
                    isDarkMode = true;
                    document.body.classList.add('dark-mode');
                    themeIcon.textContent = '‚òÄÔ∏è';
                    themeToggle.querySelector('span:last-child').textContent = '–î–Ω–µ–≤–Ω–æ–π —Ä–µ–∂–∏–º';
                }
            }

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∫–æ–¥–æ–≤ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è (1-163, –∫—Ä–æ–º–µ –∏—Å–∫–ª—é—á–µ–Ω–Ω—ã—Ö)
            function generateValidCodes() {
                const codes = [];
                for (let i = 1; i <= 163; i++) {
                    if (!EXCLUDED_CODES.includes(i)) {
                        codes.push(i);
                    }
                }
                return codes;
            }

            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∫–æ–¥–æ–≤
            function generateDecryptionCodes() {
                const validCodes = generateValidCodes();
                const interactionKeys = Object.keys(INTERACTION_TYPES);
                
                validCodes.forEach((code, index) => {
                    const figureIndex = index % HISTORICAL_FIGURES.length;
                    const interactionIndex = index % interactionKeys.length;
                    
                    const figure = HISTORICAL_FIGURES[figureIndex];
                    const interactionKey = interactionKeys[interactionIndex];
                    const interaction = INTERACTION_TYPES[interactionKey];
                    
                    const codeItem = document.createElement('div');
                    codeItem.className = 'code-item';
                    codeItem.innerHTML = `
                        <div class="code-value">–ö–æ–¥ ${code}</div>
                        <div class="code-desc">${figure} (${interactionKey} - ${interaction})</div>
                    `;
                    
                    decryptionGrid.appendChild(codeItem);
                });
            }

            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∏—Å–ª–∞ —Å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è–º–∏ —Ç—ã—Å—è—á
            function formatNumberWithSpaces(value) {
                return value.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ' ');
            }

            // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞ –ø—Ä–∏ –≤–≤–æ–¥–µ
            function formatPremiumInput(input) {
                // –£–¥–∞–ª—è–µ–º –≤—Å–µ —Å–∏–º–≤–æ–ª—ã, –∫—Ä–æ–º–µ —Ü–∏—Ñ—Ä –∏ —Ç–æ—á–∫–∏
                let value = input.value.replace(/[^\d.]/g, '');
                
                // –£–¥–∞–ª—è–µ–º –ª–∏—à–Ω–∏–µ —Ç–æ—á–∫–∏
                const parts = value.split('.');
                if (parts.length > 2) {
                    value = parts[0] + '.' + parts.slice(1).join('');
                }
                
                // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Ü–µ–ª—É—é —á–∞—Å—Ç—å
                const numberValue = parseFloat(value) || 0;
                input.value = formatNumberWithSpaces(Math.floor(numberValue)) + (value.includes('.') ? '.' + parts[parts.length - 1] : '');
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ü–µ–ª—ã—Ö —á–∏—Å–µ–ª
            function validateInteger(input, min = null, max = null) {
                const value = input.value.trim();
                const intValue = parseInt(value);
                
                if (value === '' || isNaN(intValue) || !Number.isInteger(parseFloat(value))) {
                    return { isValid: false, message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ' };
                }
                
                if (min !== null && intValue < min) {
                    return { isValid: false, message: `–ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${min}` };
                }
                
                if (max !== null && intValue > max) {
                    return { isValid: false, message: `–ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –±–æ–ª–µ–µ ${max}` };
                }
                
                return { isValid: true };
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è —á–∏—Å–ª–∞ —Å –ø–ª–∞–≤–∞—é—â–µ–π —Ç–æ—á–∫–æ–π
            function validateFloat(input, min = null) {
                const value = input.value.trim().replace(/\s/g, '');
                const floatValue = parseFloat(value);
                
                if (value === '' || isNaN(floatValue)) {
                    return { isValid: false, message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ' };
                }
                
                if (min !== null && floatValue < min) {
                    return { isValid: false, message: `–ó–Ω–∞—á–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ ${min}` };
                }
                
                return { isValid: true };
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ –∏–∑ radio-–∫–Ω–æ–ø–æ–∫
            function validateRadioGroup(groupName) {
                const selected = form.querySelector(`input[name="${groupName}"]:checked`);
                return { isValid: !!selected, message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤' };
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
            function validatePolicySalesChannel(input) {
                const value = input.value.trim();
                const intValue = parseInt(value);
                const validCodes = generateValidCodes();
                
                if (value === '' || isNaN(intValue) || !Number.isInteger(parseFloat(value))) {
                    return { isValid: false, message: '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —Ü–µ–ª–æ–µ —á–∏—Å–ª–æ' };
                }
                
                if (intValue < 1 || intValue > 163) {
                    return { isValid: false, message: '–ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –æ—Ç 1 –¥–æ 163' };
                }
                
                if (!validCodes.includes(intValue)) {
                    return { isValid: false, message: '–≠—Ç–æ—Ç –∫–æ–¥ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫—É –¥–ª—è —Å–ø–∏—Å–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∫–æ–¥–æ–≤' };
                }
                
                return { isValid: true };
            }

            // –ü–æ–∫–∞–∑/—Å–∫—Ä—ã—Ç–∏–µ –æ—à–∏–±–∫–∏
            function showError(inputId, errorId, isValid, message = '') {
                const input = document.getElementById(inputId);
                const error = document.getElementById(errorId);
                const formGroup = input.closest('.form-group');
                
                if (!isValid) {
                    formGroup.classList.add('has-error');
                    error.textContent = message;
                } else {
                    formGroup.classList.remove('has-error');
                    error.textContent = '';
                }
                
                return isValid;
            }

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ–π —Ñ–æ—Ä–º—ã
            function validateForm() {
                let isValid = true;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞
                const ageValidation = validateInteger(document.getElementById('age'), 0, 85);
                isValid = showError('age', 'ageError', ageValidation.isValid, ageValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–∞
                const genderValidation = validateRadioGroup('gender');
                isValid = showError('genderGroup', 'genderError', genderValidation.isValid, genderValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–∞–≤
                const drivingLicenseValidation = validateRadioGroup('drivingLicense');
                isValid = showError('drivingLicenseGroup', 'drivingLicenseError', drivingLicenseValidation.isValid, drivingLicenseValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–∞ —Ä–µ–≥–∏–æ–Ω–∞
                const regionCodeValidation = validateInteger(document.getElementById('regionCode'), 0, 52);
                isValid = showError('regionCode', 'regionCodeError', regionCodeValidation.isValid, regionCodeValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏ –Ω–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç
                const previouslyInsuredValidation = validateRadioGroup('previouslyInsured');
                isValid = showError('previouslyInsuredGroup', 'previouslyInsuredError', previouslyInsuredValidation.isValid, previouslyInsuredValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –≤–æ–∑—Ä–∞—Å—Ç–∞ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
                const vehicleAgeValidation = validateInteger(document.getElementById('vehicleAge'), 0);
                isValid = showError('vehicleAge', 'vehicleAgeError', vehicleAgeValidation.isValid, vehicleAgeValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏–π –∞–≤—Ç–æ–º–æ–±–∏–ª—è
                const vehicleDamageValidation = validateRadioGroup('vehicleDamage');
                isValid = showError('vehicleDamageGroup', 'vehicleDamageError', vehicleDamageValidation.isValid, vehicleDamageValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞
                const annualPremiumValidation = validateFloat(document.getElementById('annualPremium'), 0);
                isValid = showError('annualPremium', 'annualPremiumError', annualPremiumValidation.isValid, annualPremiumValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–¥–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
                const policySalesChannelValidation = validatePolicySalesChannel(policySalesChannelInput);
                isValid = showError('policySalesChannel', 'policySalesChannelError', policySalesChannelValidation.isValid, policySalesChannelValidation.message) && isValid;
                
                // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π
                const vintageValidation = validateInteger(document.getElementById('vintage'), 0);
                isValid = showError('vintage', 'vintageError', vintageValidation.isValid, vintageValidation.message) && isValid;
                
                return isValid;
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ —Ä–∞—Å—á–µ—Ç–∞
            function updateResult(probability) {
                // –ü–æ–∫–∞–∑–∞—Ç—å —Å–µ–∫—Ü–∏—é —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
                resultSection.classList.add('show');
                
                // –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç—å –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
                setTimeout(() => {
                    resultSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
                
                // –û–±–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
                probabilityValue.textContent = `${probability}%`;
                probabilityValue.classList.remove('show');
                
                // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
                setTimeout(() => {
                    probabilityValue.classList.add('show');
                }, 50);
                
                // –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
                let description = '';
                if (probability < 20) {
                    description = '–ù–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.';
                } else if (probability < 40) {
                    description = '–£–º–µ—Ä–µ–Ω–Ω–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –í–æ–∑–º–æ–∂–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å –∫–ª–∏–µ–Ω—Ç–æ–º.';
                } else if (probability < 60) {
                    description = '–°—Ä–µ–¥–Ω—è—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω –ø—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ.';
                } else if (probability < 80) {
                    description = '–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –ö–ª–∏–µ–Ω—Ç —è–≤–Ω–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.';
                } else {
                    description = '–û—á–µ–Ω—å –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –ö–ª–∏–µ–Ω—Ç, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –æ—Ñ–æ—Ä–º–∏—Ç —Å—Ç—Ä–∞—Ö–æ–≤–∫—É.';
                }

                // if (probability < 69) {
                //     description = '–ù–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.';
                // } else {
                //     description = '–í—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–∫–∏. –ö–ª–∏–µ–Ω—Ç —è–≤–Ω–æ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω.';
                // }
                
                probabilityDescription.textContent = description;
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
            form.addEventListener('submit', async function(e) {
                e.preventDefault();
                
                if (!validateForm()) {
                    return;
                }
                
                // –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
                calculateBtn.disabled = true;
                calculateBtn.classList.add('loading');
                calculateBtn.textContent = '–†–∞—Å—á–µ—Ç...';
                
                // –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
                const formData = new FormData(form);
                
                // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –±–µ–∫–µ–Ω–¥–∞
                const backendData = {
                    Age: parseInt(formData.get('age')),
                    Gender: formData.get('gender') === '–ú—É–∂—á–∏–Ω–∞' ? 'Male' : 'Female',
                    Driving_License: parseInt(formData.get('drivingLicense')),
                    Region_Code: parseInt(formData.get('regionCode')),
                    Previously_Insured: parseInt(formData.get('previouslyInsured')),
                    Vehicle_Age: parseInt(formData.get('vehicleAge')),
                    Vehicle_Damage: parseInt(formData.get('vehicleDamage')),
                    Annual_Premium: parseFloat(formData.get('annualPremium').replace(/\s/g, '')),
                    Policy_Sales_Channel: parseInt(formData.get('policySalesChannel')),
                    Vintage: parseInt(formData.get('vintage'))
                };
                
                 const vehicleAgeYears = parseInt(formData.get('vehicleAge'));
                backendData.Vehicle_Age =
                  vehicleAgeYears < 1 ? '< 1 Year' :
                  vehicleAgeYears <= 2 ? '1-2 Year' :
                  '> 2 Years';

                  backendData.Vehicle_Damage =
                  (formData.get('vehicleDamage') === '1') ? 'Yes' : 'No';
                
                try {
                     const params = new URLSearchParams(backendData).toString();
                     const response = await fetch(
                         `/api/predict?${params}`,
                  {
                    method: 'GET',
                    headers: { 'Accept': 'application/json' }
                  }
                );
                
                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.detail || '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞');
                }
            
                const result = await response.json();
            
                updateResult(Math.round(result.probability * 100));
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞:', error);
                    alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API: ' + error.message);
                } finally {
                    // –°–∫—Ä—ã—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
                    calculateBtn.disabled = false;
                    calculateBtn.classList.remove('loading');
                    calculateBtn.textContent = '–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å';
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–∞—Ö–æ–≤–æ–≥–æ –≤–∑–Ω–æ—Å–∞
            const annualPremiumInput = document.getElementById('annualPremium');
            annualPremiumInput.addEventListener('input', function() {
                formatPremiumInput(this);
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∏ –∫–æ–¥–æ–≤
            decryptionToggle.addEventListener('click', function() {
                decryptionContent.classList.toggle('active');
                toggleIcon.textContent = decryptionContent.classList.contains('active') ? '‚ñ≤' : '‚ñº';
            });

            // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
            form.addEventListener('input', function(e) {
                const target = e.target;
                
                // –î–ª—è —Ä–∞–¥–∏–æ-–∫–Ω–æ–ø–æ–∫ –≤–∞–ª–∏–¥–∏—Ä—É–µ–º –≤—Å—é –≥—Ä—É–ø–ø—É
                if (target.type === 'radio') {
                    const groupName = target.name;
                    if (groupName === 'gender') {
                        showError('genderGroup', 'genderError', true);
                    } else if (groupName === 'drivingLicense') {
                        showError('drivingLicenseGroup', 'drivingLicenseError', true);
                    } else if (groupName === 'previouslyInsured') {
                        showError('previouslyInsuredGroup', 'previouslyInsuredError', true);
                    } else if (groupName === 'vehicleDamage') {
                        showError('vehicleDamageGroup', 'vehicleDamageError', true);
                    }
                }
                
                // –î–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π –≤–∞–ª–∏–¥–∏—Ä—É–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ
                else if (target.id === 'age') {
                    const validation = validateInteger(target, 0, 85);
                    showError('age', 'ageError', validation.isValid, validation.message);
                } else if (target.id === 'regionCode') {
                    const validation = validateInteger(target, 0, 52);
                    showError('regionCode', 'regionCodeError', validation.isValid, validation.message);
                } else if (target.id === 'vehicleAge') {
                    const validation = validateInteger(target, 0);
                    showError('vehicleAge', 'vehicleAgeError', validation.isValid, validation.message);
                } else if (target.id === 'annualPremium') {
                    formatPremiumInput(target);
                    const validation = validateFloat(target, 0);
                    showError('annualPremium', 'annualPremiumError', validation.isValid, validation.message);
                } else if (target.id === 'vintage') {
                    const validation = validateInteger(target, 0);
                    showError('vintage', 'vintageError', validation.isValid, validation.message);
                } else if (target.id === 'policySalesChannel') {
                    const validation = validatePolicySalesChannel(target);
                    showError('policySalesChannel', 'policySalesChannelError', validation.isValid, validation.message);
                }
            });

            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã
            themeToggle.addEventListener('click', toggleTheme);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
            initTheme();
            generateDecryptionCodes();
            
            // –ó–∞–ø—Ä–µ—Ç –≤–≤–æ–¥–∞ –Ω–µ—á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ —á–∏—Å–ª–æ–≤—ã–µ –ø–æ–ª—è
            const numberInputs = document.querySelectorAll('input[type="number"]');
            numberInputs.forEach(input => {
                input.addEventListener('keypress', function(e) {
                    // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã, Backspace, Tab, —Å—Ç—Ä–µ–ª–∫–∏
                    if (!/\d/.test(e.key) && 
                        !['Backspace', 'Tab', 'ArrowLeft', 'ArrowRight', 'Delete'].includes(e.key)) {
                        e.preventDefault();
                    }
                });
            });

            // –û—Å–æ–±—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è –ø–æ–ª—è –∫–æ–¥–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è - —Ä–∞–∑—Ä–µ—à–∞–µ–º –≤–≤–æ–¥ –∏ —É–¥–∞–ª–µ–Ω–∏–µ
            policySalesChannelInput.addEventListener('input', function(e) {
                // –†–∞–∑—Ä–µ—à–∞–µ–º –ª—é–±–æ–π –≤–≤–æ–¥, –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã
                // –û—á–∏—â–∞–µ–º –æ—à–∏–±–∫—É –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –≤–≤–æ–¥–∞
                showError('policySalesChannel', 'policySalesChannelError', true);
            });
        });
    </script>
</body>
</html>


